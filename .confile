#!/usr/bin/env ruby

rake do
  require 'cucumber'
  require 'cucumber/rake/task'

  ::Cucumber::Rake::Task.new(:features) do |t|
    t.cucumber_opts = "features --format pretty"
  end
end

vclog do
  set :major,    2, "Major Enhancements"
  set :minor,    1, "Minor Enhancements"
  set :bug,      0, "Bug Fixes"
  set :doc,     -1, "Documentation Changes"
  set :default, -2, "Nominal Changes"
  set :admin,   -3, "Administrative Changes"

  on /^(\w+):/ do |commit, md|
    commit.type = md[1].to_sym
    commit.message = commit.message.sub(md[0],'').strip
    true
  end

  on /\[(\w+)\]\s*$/ do |commit, md|
    commit.type = md[1].to_sym
    commit.message = commit.message.sub(md[0],'').strip
    true
  end

  on /updated? (README|PROFILE|PACKAGE|VERSION|MANIFEST)/ do |commit|
    commit.type = :admin
  end

  on /(bump|bumped|prepare) version/ do |commit|
    commit.type = :admin
  end
end

